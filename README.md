# 🤖 基于LLM的企业年报信息自动化抽取系统

> 使用大语言模型从企业年报中自动提取结构化商业信息

![Python](https://img.shields.io/badge/Python-3.12-blue)
![License](https://img.shields.io/badge/License-MIT-green)

---

## 📖 项目简介

传统的年报信息提取需要人工逐页阅读，效率低下。本项目使用**智谱AI GLM-4模型**，通过Prompt Engineering自动从非结构化文本中提取关键商业信息，并输出为结构化Excel表格。

**案例场景**: 从中国石油年报中提取非洲业务相关信息

---

## ✨ 核心功能

- 🎯 **智能分类**: 自动识别文本是否包含商业信息
- 📊 **结构化抽取**: 提取5维度信息（业务名称/业务方/时间/标的物/金额）
- 🔧 **长文档处理**: 自动分句（最大512字符），避免超出模型上下文窗口
- 📈 **Excel导出**: 一键生成可分析的数据报表
- ✅ **质量验证**: TF-IDF+KMeans聚类分析验证提取准确性

---

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置API Key
```bash
# 复制环境变量模板
cp .env.example .env

# 编辑.env文件，填入你的智谱AI API Key
# 获取地址: https://open.bigmodel.cn/
```

### 3. 运行项目
```bash
jupyter notebook cnpc_africa_business_info_extract_fin_cleaned.ipynb
```

按顺序运行各个cell即可。

---

## 📊 输出示例

**输入文本**:
> "海外油气业务 2018年，本集团海外油气合作抓住"一带一路"战略实施等机遇..."

**输出结果**:
| 业务名称 | 业务方 | 时间 | 标的物 | 金额（USD） |
|---------|--------|------|--------|------------|
| 海外油气业务 | 本集团 | 2018.06.30 | 油气合作 | - |

处理**56条**年报片段，成功提取**56条**结构化记录。

---

## 🛠️ 技术栈

- **LLM**: 智谱AI GLM-4-Flash
- **数据处理**: Pandas, NumPy
- **NLP**: Jieba (中文分词), NLTK
- **机器学习**: Scikit-learn (TF-IDF, KMeans)
- **文件处理**: OpenPyxl (Excel导出)

---

## 💡 技术亮点

1. **Prompt工程**: 设计系统prompt和格式化输出要求，引导模型生成结构化JSON
2. **异常处理**: 处理模型输出格式不稳定（去除```json```标记、处理"无关"回复）
3. **文本预处理**: 实现智能分句算法，保证每段不超过512字符
4. **效果验证**: 使用无监督学习验证提取信息的主题一致性

---

## 📁 项目结构

```
.
├── cnpc_africa_business_info_extract_fin_cleaned.ipynb  # 主程序（已移除API Key）
├── requirements.txt                                      # 依赖列表
├── .env.example                                          # 环境变量模板
├── .gitignore                                            # Git忽略文件
└── README.md                                             # 项目说明
```

---

## 🔒 安全说明

⚠️ **请勿将API Key硬编码到代码中！** 

本项目使用`.env`文件管理敏感信息：
- `.env.example` 是模板文件（可提交到Git）
- `.env` 包含真实API Key（已加入`.gitignore`）

---

## 📈 性能表现

- **处理速度**: 约每条文本2-3秒（取决于API响应速度）
- **抽取准确率**: 人工抽样验证约90%+
- **数据规模**: 成功处理56条年报片段

---

## 🎯 应用场景

- ✅ 企业年报分析与竞品研究
- ✅ 商业信息情报收集
- ✅ 金融文档智能处理
- ✅ 合规文档要素提取

---

## 📝 待优化方向

- [ ] 支持更多LLM模型（OpenAI GPT-4, Claude等）
- [ ] 增加自动化评估指标
- [ ] 优化Prompt以提升准确率
- [ ] 支持PDF直接解析
- [ ] 添加Web可视化界面

---

## 📄 开源协议

MIT License - 可自由使用、修改和分发

---

## 👤 作者

湖南大学 国际经济与贸易专业 黄承烨

如有问题欢迎提Issue或PR！

---

## 本项目为《大语言模型与经济学研究》课程实践项目。

⚠️ **免责声明**: 本项目仅用于学习和研究目的，提取数据的准确性需人工验证。
